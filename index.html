<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>HBD love</title>
    <style>
        * { margin: 0; padding: 0; }
        body { 
            font: 12px "Helvetica Neue", Helvetica, "Microsoft YaHei", Arial, sans-serif; 
            background: #000; 
            color: #333; 
            overflow: hidden;
        }
        #main { width: 100%; }
        #wrap { 
            position: relative; 
            margin: 0 auto; 
            width: 1100px; 
            height: 680px; 
            margin-top: 10px; 
        }
        #text { 
            width: 400px; 
            height: 425px; 
            left: 60px; 
            top: 80px; 
            position: absolute; 
        }
        #code { 
            display: none; 
            font-size: 16px; 
            color: #666; 
        }
        #clock-box { 
            position: absolute; 
            left: 60px; 
            top: 550px; 
            font-size: 28px; 
            display: none; 
            color: #666; 
        }
        #clock { margin-left: 48px; }
        #canvas { 
            margin: 0 auto; 
            width: 1100px; 
            height: 680px; 
        }
        .hand { cursor: pointer; }
        .say { 
            margin-left: 5px; 
            color: #666; 
            display: block;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <div id="main">
        <audio loop id="myAudio">
            <source src="aud.mp3" type="audio/mpeg">
        </audio>
        <div id="wrap">
            <div id="text">
                <div id="code">
                    <span class="say">Hey you üíû</span><br>
                    <span class="say">Happy Birthday üéà</span><br>
                    <span class="say">May God bless you üçÄ</span><br>
                    <span class="say">And give u many happiness üíï</span><br>
                    <span class="say">Just saying... you're pretty awesome ‚ù§Ô∏è</span><br>
                    <span class="say">Sending good vibes and maybe a wink üòè</span><br>
                    <span class="say">Hope u have a great day today ‚ù§Ô∏èüòò</span><br>
                </div>
            </div>
            <div id="clock-box">
                <span id="clock">577 days 0 hours 0 minutes 0 seconds</span>
            </div>
            <canvas id="canvas" width="1100" height="680"></canvas>
        </div>
    </div>

    <script>
        // Simple animation without external dependencies
        (function() {
            var canvas = document.getElementById('canvas');
            var ctx = canvas.getContext('2d');
            var width = canvas.width;
            var height = canvas.height;
            
            // Heart seed at bottom center
            var heart = {
                x: width / 2 - 20,
                y: height,
                size: 35,
                color: 'rgb(190, 26, 37)',
                scale: 2
            };
            
            // Draw heart shape
            function drawHeart(x, y, size, color) {
                ctx.save();
                ctx.fillStyle = color;
                ctx.shadowColor = color;
                ctx.shadowBlur = 3;
                ctx.translate(x, y);
                ctx.scale(1, -1);
                ctx.beginPath();
                ctx.arc(0, 0, size/2, Math.PI, Math.PI * 2);
                ctx.arc(-size, 0, size/2, 0, Math.PI);
                ctx.lineTo(0, -size * 2);
                ctx.closePath();
                ctx.fill();
                ctx.restore();
            }
            
            // Draw tree branch
            function drawBranch(x1, y1, x2, y2, width) {
                ctx.save();
                ctx.strokeStyle = 'rgb(35, 31, 32)';
                ctx.shadowColor = 'rgb(35, 31, 32)';
                ctx.shadowBlur = 2;
                ctx.lineWidth = width;
                ctx.beginPath();
                ctx.moveTo(x1, y1);
                ctx.lineTo(x2, y2);
                ctx.stroke();
                ctx.restore();
            }
            
            // Draw flower
            function drawFlower(x, y, radius, color) {
                var petals = 8;
                for (var i = 0; i < petals; i++) {
                    var angle = (Math.PI * 2 / petals) * i;
                    ctx.save();
                    ctx.translate(x, y);
                    ctx.rotate(angle);
                    ctx.fillStyle = color;
                    ctx.beginPath();
                    ctx.ellipse(0, radius/2, radius/3, radius/2, 0, 0, Math.PI * 2);
                    ctx.fill();
                    ctx.restore();
                }
            }
            
            // Animation state
            var animationStep = 0;
            var heartY = height;
            var heartSize = 35 * 2;
            var treeGrown = false;
            var flowersDrawn = false;
            var textIndex = 0;
            var textContent = document.getElementById('code').innerHTML;
            var flowers = []; // Store flower positions to prevent flickering
            
            // Main animation loop
            function animate() {
                ctx.clearRect(0, 0, width, height);
                
                // Step 1: Shrink and move heart
                if (animationStep < 100) {
                    var scale = 1 - (animationStep / 100) * 0.8;
                    drawHeart(heart.x, heartY, heartSize * scale, heart.color);
                    heartY -= 2;
                    animationStep++;
                }
                // Step 2: Grow tree
                else if (animationStep < 300) {
                    var progress = (animationStep - 100) / 200;
                    
                    // Main trunk
                    var trunkHeight = 430 * progress;
                    drawBranch(heart.x, height - 100, heart.x, height - 100 - trunkHeight, 30);
                    
                    if (progress > 0.3) {
                        // Left branch
                        var leftProgress = (progress - 0.3) / 0.7;
                        drawBranch(heart.x, height - 200, 
                                   heart.x - 150 * leftProgress, 
                                   height - 300 * leftProgress, 
                                   15);
                    }
                    
                    if (progress > 0.5) {
                        // Right branch
                        var rightProgress = (progress - 0.5) / 0.5;
                        drawBranch(heart.x, height - 250, 
                                   heart.x + 180 * rightProgress, 
                                   height - 380 * rightProgress, 
                                   12);
                    }
                    
                    animationStep++;
                    if (animationStep === 300) {
                        treeGrown = true;
                    }
                }
                // Step 3: Add flowers
                else if (animationStep < 400 && treeGrown) {
                    // Redraw tree
                    drawBranch(heart.x, height - 100, heart.x, height - 530, 30);
                    drawBranch(heart.x, height - 200, heart.x - 150, height - 300, 15);
                    drawBranch(heart.x, height - 250, heart.x + 180, height - 380, 12);
                    
                    // Generate flowers once and store them
                    var targetFlowerCount = Math.floor((animationStep - 300) / 2);
                    while (flowers.length < targetFlowerCount && flowers.length < 50) {
                        flowers.push({
                            x: 50 + Math.random() * (width - 100),
                            y: 50 + Math.random() * (height - 100),
                            radius: 8 + Math.random() * 4,
                            color: 'rgba(' + 
                                Math.floor(128 + Math.random() * 127) + ',' +
                                Math.floor(Math.random() * 128) + ',' +
                                Math.floor(Math.random() * 128) + ',0.3)'
                        });
                    }
                    
                    // Draw all stored flowers
                    for (var i = 0; i < flowers.length; i++) {
                        drawFlower(flowers[i].x, flowers[i].y, flowers[i].radius, flowers[i].color);
                    }
                    
                    animationStep++;
                }
                // Step 4: Show text
                else if (!flowersDrawn) {
                    flowersDrawn = true;
                    document.getElementById('code').style.display = 'block';
                    typeWriter();
                    return; // Stop animation loop
                }
                
                requestAnimationFrame(animate);
            }
            
            // Typewriter effect
            function typeWriter() {
                var codeElement = document.getElementById('code');
                codeElement.innerHTML = '';
                var tempDiv = document.createElement('div');
                tempDiv.innerHTML = textContent;
                var textNodes = tempDiv.querySelectorAll('.say');
                var currentLine = 0;
                var currentChar = 0;
                
                function type() {
                    if (currentLine < textNodes.length) {
                        var currentText = textNodes[currentLine].textContent;
                        if (currentChar === 0) {
                            var span = document.createElement('span');
                            span.className = 'say';
                            codeElement.appendChild(span);
                            codeElement.appendChild(document.createElement('br'));
                        }
                        
                        var spans = codeElement.querySelectorAll('.say');
                        var activeSpan = spans[spans.length - 1];
                        
                        if (currentChar < currentText.length) {
                            activeSpan.textContent = currentText.substring(0, currentChar + 1) + '_';
                            currentChar++;
                            setTimeout(type, 75);
                        } else {
                            activeSpan.textContent = currentText;
                            currentLine++;
                            currentChar = 0;
                            setTimeout(type, 200);
                        }
                    } else {
                        setTimeout(function() {
                            document.getElementById('clock-box').style.display = 'block';
                            fadeIn(document.getElementById('clock-box'));
                        }, 2000);
                    }
                }
                
                type();
            }
            
            function fadeIn(element) {
                var opacity = 0;
                element.style.opacity = 0;
                var timer = setInterval(function() {
                    if (opacity >= 1) {
                        clearInterval(timer);
                    }
                    element.style.opacity = opacity;
                    opacity += 0.1;
                }, 50);
            }
            
            // Click to start
            function startAnimation() {
                var audio = document.getElementById('myAudio');
                audio.play().catch(function() {
                    // Audio play might be blocked by browser
                });
                canvas.style.cursor = 'default';
                animate();
                canvas.removeEventListener('click', startAnimation);
            }
            
            canvas.addEventListener('click', startAnimation);
            
            canvas.style.cursor = 'pointer';
            drawHeart(heart.x, heartY, heartSize, heart.color);
        })();
    </script>
</body>
</html>
